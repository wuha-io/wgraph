{"version":3,"sources":["../../../src/example/public/script.js"],"names":[],"mappings":"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","file":"script.js","sourcesContent":["'use strict'\r\n\r\nlet drawGraph = null\r\n\r\nlet props = document.createElement('div')\r\nprops.id = 'props'\r\ndocument.body.appendChild(props)\r\n\r\nlet container = document.createElement('div')\r\ncontainer.id = 'container'\r\ndocument.body.appendChild(container)\r\n\r\nlet showProps = data => { $(props).JSONView(data) }\r\n\r\nlet upContainerHeight = () => { container.style.height = (window.innerHeight - 30) + 'px' }\r\nupContainerHeight()\r\n\r\nlet qParams = {}\r\nlet searchParts = location.search.substr(1).split('&')\r\nsearchParts.forEach(sp => { sp = sp.split('='); qParams[sp[0]] = sp[1] })\r\n\r\nif (!qParams.name) { \r\n\twindow.location = '/?name=point'\r\n\tthrow new Error('End of process')\r\n}\r\n\r\nlet loadGraph = id => {\r\n\treturn new Promise((res, rej) => {\r\n\t\tlet xhr = new XMLHttpRequest()\r\n\t\txhr.open('GET', '/graph/' + id, true);\r\n\t\txhr.onreadystatechange = () => {\r\n\t\t\tif (xhr.readyState !== 4) return;\r\n\t\t\tif (xhr.status !== 200) return rej(xhr.responseText)\r\n\t\t\tres(JSON.parse(xhr.responseText))\r\n\t\t};\r\n\t\txhr.send()\r\n\t})\r\n}\r\n\r\nlet layout = {\r\n\tname: 'breadthfirst',\r\n  directed: true,\r\n  padding: 5\r\n}\r\n\r\nlet nodeStyle = cytoscape.stylesheet()\r\n\t.selector('node')\r\n\t\t.css({\r\n      height: 40,\r\n      width: 40,\r\n      'background-fit': 'cover',\r\n      'border-color': '#03213D',\r\n      'background-color': '#CEE3F6',\r\n      'border-width': 1,\r\n      content: 'data(name)',\r\n      'text-transform': 'uppercase',\r\n      color: '#165999'\r\n\t\t})\r\n\t.selector('edge')\r\n  \t.css({\r\n      width: 3,\r\n      'line-color': '#EAF5FF',\r\n      'target-arrow-shape': 'triangle',\r\n      'target-arrow-color': '#82C3FF',\r\n      content: 'data(name)',\r\n      color: '#03213D',\r\n      'font-size': '0.5em'\r\n  \t})\r\n\t/*.selector(':selected')\r\n\t\t.css({\r\n\t\t\t'background-color': '#B4CCE3',\r\n\t\t\t'line-color': '#DDE9F4'\r\n\t\t})*/\r\n\t.selector('.faded')\r\n\t\t.css({\r\n\t\t\topacity: 0.5\r\n\t\t})\r\n\r\nloadGraph(qParams.name).then(elements => {\r\n\r\n\tdrawGraph = () => {\r\n\r\n\t\tlet opts = {};\r\n\r\n\t\topts.container = container\r\n\t\topts.layout = layout\r\n\t\topts.style = nodeStyle\r\n\r\n\t\topts.elements = {}\r\n\r\n\t\topts.elements.nodes = elements.nodes.map((node, i) => { \r\n\t\t\treturn {\r\n\t\t\t\tdata: {\r\n    \t\t\tid: node, \r\n    \t\t\tname: node, \r\n    \t\t\tprops: elements.props.nodes[i]\r\n  \t\t\t}\r\n  \t\t}\r\n  \t})\r\n\r\n  \topts.elements.edges = elements.edges.map((edge, i) => {\r\n  \t\treturn {\r\n  \t\t\tdata: {\r\n    \t\t\tsource: edge.subject, \r\n    \t\t\ttarget: edge.object, \r\n    \t\t\tname: edge.predicate,\r\n    \t\t\tprops: elements.props.edges[i]\r\n    \t\t}\r\n    \t}\r\n    })\r\n\r\n    let selectElem = e => {\r\n    \tlet elem = e.cyTarget\r\n    \tlet selected = elem.neighborhood().add(elem)\r\n\t\t\tcy.elements().addClass('faded')\r\n\t\t\tselected.removeClass('faded')\r\n\t\t\tshowProps(elem.data())\r\n    }\r\n\r\n\t\tcontainer.html = null;\r\n\t\t\r\n\t\tlet cy = cytoscape(opts)\r\n\t\t\t.on('tap', 'node', selectElem)\r\n\t\t\t.on('tap', 'edge', selectElem)\r\n\t\t\t.on('tap', e => {\r\n\t\t\t\tif (e.cyTarget === cy)\r\n\t\t\t\t\tcy.elements().removeClass('faded')\r\n\t\t\t})\r\n\r\n\t\t//cy.ready(() => {})\r\n\t}\r\n\r\n\twindow.addEventListener('resize', () => {\r\n\t\tupContainerHeight()\r\n\t\tdrawGraph()\r\n\t})\r\n\r\n\tdrawGraph()\r\n\r\n}).catch(console.error.bind(console))\r\n"]}